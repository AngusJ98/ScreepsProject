{"code":"import { Roles, Setups } from \"Creep_Setups/Setups\";\r\nimport { Manager } from \"Manager\";\r\nimport { ManagerPriority } from \"./ManagerPriority\";\r\nexport class QueenManager extends Manager {\r\n    constructor(barracks, prio = ManagerPriority.Core.queen) {\r\n        super(barracks, \"QueenManager_\" + barracks.coreSpawn.id, prio);\r\n        this.refillTowersBelow = 500;\r\n        this.barracks = barracks;\r\n        this.queens = this.creepsByRole[Roles.queen];\r\n        this.queenSetup = this.capital.storage ? Setups.queens.default : Setups.queens.early;\r\n        this.targets = _.filter(this.barracks.energyStructures, r => r.store.getFreeCapacity(RESOURCE_ENERGY) > 0);\r\n        this.towers = _.filter(this.capital.towers, r => r.energy < r.energyCapacity);\r\n        this.targets = this.targets.concat(this.towers);\r\n    }\r\n    handleQueen(queen) {\r\n        if (queen.store.energy > 0) {\r\n            this.transferActions(queen);\r\n        }\r\n        else {\r\n            this.withdrawActions(queen);\r\n        }\r\n    }\r\n    transferActions(queen) {\r\n        let target = queen.pos.findClosestByPath(this.targets);\r\n        if (target) {\r\n            queen.goTransfer(target);\r\n        }\r\n        else {\r\n            this.withdrawActions(queen);\r\n        }\r\n    }\r\n    withdrawActions(queen) {\r\n        let drops = _.filter(this.room.droppedEnergy, r => r.amount >= queen.store.getCapacity() / 4);\r\n        let structs = _.filter(this.capital.room.storageUnits, r => r.store.energy >= queen.store.getCapacity() / 2);\r\n        let targets = _.merge(drops, structs);\r\n        //console.log(JSON.stringify(this.room.drops))\r\n        let target = queen.pos.findClosestByRange(targets);\r\n        if (target) {\r\n            queen.goWithdraw(target);\r\n        }\r\n    }\r\n    init() {\r\n        let pre = this.barracks.spawns.length <= 1 ? 100 : 50;\r\n        this.spawnList(1, this.queenSetup, { prespawn: pre });\r\n        if (this.queens && this.queens.length == 1 && this.queens[0].body.length < 5) {\r\n            this.spawnList(2, this.queenSetup, { prespawn: pre });\r\n        }\r\n    }\r\n    run() {\r\n        _.forEach(this.queens, r => this.handleQueen(r));\r\n    }\r\n}\r\n//# sourceMappingURL=QueenManager.js.map","references":["C:/Users/ADMIN BOI/Documents/GitHub/ScreepsProject/src/Buildings/Barracks.ts","C:/Users/ADMIN BOI/Documents/GitHub/ScreepsProject/src/Creep_Setups/CreepSetup.ts","C:/Users/ADMIN BOI/Documents/GitHub/ScreepsProject/src/Creep_Setups/Setups.ts","C:/Users/ADMIN BOI/Documents/GitHub/ScreepsProject/src/Manager.ts","C:/Users/ADMIN BOI/Documents/GitHub/ScreepsProject/src/Managers/ManagerPriority.ts"],"map":"{\"version\":3,\"file\":\"QueenManager.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../src/Managers/QueenManager.ts\"],\"names\":[],\"mappings\":\"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\"}"}
