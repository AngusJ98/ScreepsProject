{"code":"//capitals are our claimed rooms. All managers will be assigned to a capital. This allows managers to spawn creeps\r\n//for other rooms to use and manager military code\r\nimport { Barracks } from \"Buildings/Barracks\";\r\nimport { MiningSite } from \"Buildings/MiningSite\";\r\nimport { WorkManager } from \"Managers/WorkManager\";\r\nexport var CapitalSize;\r\n(function (CapitalSize) {\r\n    CapitalSize[CapitalSize[\"Town\"] = 0] = \"Town\";\r\n    CapitalSize[CapitalSize[\"City\"] = 1] = \"City\";\r\n    CapitalSize[CapitalSize[\"Megacity\"] = 2] = \"Megacity\";\r\n})(CapitalSize || (CapitalSize = {}));\r\nexport class Capital {\r\n    constructor(room) {\r\n        this.name = \"Capital_\" + room.name;\r\n        this.capital = this;\r\n        this.room = room;\r\n        this.outposts = _.map(Memory.capitals.outposts, r => Game.rooms[r]) || [];\r\n        this.allRooms = this.outposts.concat([this.room]);\r\n        this.roomNames = _.map(this.allRooms, r => r.name);\r\n        this.controller = this.room.controller;\r\n        this.pos = this.controller.pos;\r\n        this.spawns = _.filter(this.room.spawns, spawn => spawn.my);\r\n        this.extensions = this.room.extensions;\r\n        this.storage = this.room.storage;\r\n        this.links = this.room.links;\r\n        this.availableLinks = _.clone(this.links);\r\n        this.terminal = this.room.terminal;\r\n        this.towers = this.room.towers;\r\n        this.labs = this.room.labs;\r\n        this.powerSpawn = this.room.powerSpawn;\r\n        this.nuker = this.room.nuker;\r\n        this.observer = this.room.observer;\r\n        this.containers = this.room.containers;\r\n        this.level = this.controller.level;\r\n        if (this.storage && this.storage.isActive() && this.spawns[0]) {\r\n            if (this.level = 8) {\r\n                this.stage = CapitalSize.Megacity;\r\n            }\r\n            else {\r\n                this.stage = CapitalSize.City;\r\n            }\r\n        }\r\n        else {\r\n            this.stage = CapitalSize.Town;\r\n        }\r\n        this.sources = _.compact(_.flatten(_.map(this.allRooms, room => room.sources))); //all sources, including those in outposts\r\n        _.map(this.sources, r => console.log(r.id));\r\n        this.constructionSites = _.flatten(_.map(this.allRooms, room => room.constructionSites)); //all construction sites\r\n        this.repairables = _.flatten(_.map(this.allRooms, room => room.repairables)); // all objects needing repair\r\n        this.creeps = global.creepsByCapital[this.name];\r\n        this.creepsByRole = _.groupBy(this.creeps, r => r.memory.role);\r\n        this.creepsByManager = _.groupBy(this.creeps, r => r.memory.manager);\r\n        this.hostiles = _.flatten(_.map(this.allRooms, room => room.hostiles)); //hostile creeps in all rooms\r\n        this.miningSites = [];\r\n        this.barracks = undefined;\r\n        this.buildings = [];\r\n        this.managers = [];\r\n        this.workManager = new WorkManager(this);\r\n        this.createBuildings();\r\n    }\r\n    //Method to start all buildings\r\n    createBuildings() {\r\n        if (this.spawns[0]) {\r\n            this.barracks = new Barracks(this, this.spawns[0]);\r\n        }\r\n        for (let source of this.sources) {\r\n            console.log(source);\r\n            let site = new MiningSite(this, source);\r\n            this.miningSites.push(site);\r\n        }\r\n    }\r\n    init() {\r\n        _.forEach(this.buildings, r => r.init());\r\n        _.forEach(this.managers, r => r.init());\r\n    }\r\n    run() {\r\n        _.forEach(this.buildings, r => r.run());\r\n        _.forEach(this.managers, r => r.run());\r\n    }\r\n}\r\n//# sourceMappingURL=Capital.js.map","references":["C:/Users/ADMIN BOI/Documents/GitHub/ScreepsProject/src/Buildings/Barracks.ts","C:/Users/ADMIN BOI/Documents/GitHub/ScreepsProject/src/Buildings/Building.ts","C:/Users/ADMIN BOI/Documents/GitHub/ScreepsProject/src/Buildings/MiningSite.ts","C:/Users/ADMIN BOI/Documents/GitHub/ScreepsProject/src/Manager.ts","C:/Users/ADMIN BOI/Documents/GitHub/ScreepsProject/src/Managers/WorkManager.ts","C:/Users/ADMIN BOI/Documents/GitHub/ScreepsProject/src/Room/Room_Find.ts"],"map":"{\"version\":3,\"file\":\"Capital.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../src/Room/Capital.ts\"],\"names\":[],\"mappings\":\"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\"}"}
